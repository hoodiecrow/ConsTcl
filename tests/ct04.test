package require tcltest
source constcl.tcl
namespace import -force tcltest::*


test read-20.0 {try reading quoted symbol} -body {
    pw "'foo"
} -output "(quote foo)\n"

test read-20.1 {try modifying quoted list} -body {
    pew "(define a '(a b c))"
    pew "(list-set! a 1 'x)"
} -returnCodes error -result "Can't modify a constant pair"

test read-20.2 {try read-expr on quoted expr} -setup {
    makeFile {  'foo } testrr.lsp
    set p [pe {(open-input-file "testrr.lsp")}]
} -body {
    rw $p
} -cleanup {
    ::constcl::close-input-port $p
    removeFile testrr.lsp
} -output "(quote foo)\n"



cleanupTests
return
