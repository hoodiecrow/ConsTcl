
package require tcltest
namespace import -force tcltest::*
source constcl.tcl

test read-14.0 {try reading an identifier} {
    set expr [p "foo"]
    $expr name
} "foo"

test read-14.1 {try reading an identifier} -body {
    set expr [p "let"]
    ::constcl::varcheck [$expr name]
} -returnCodes error -result "Variable name is reserved: let"

test read-14.2 {try read-expr on identifiers} -setup {
    makeFile {  foo    bar } testrr.lsp
    set p [pe {(open-input-file "testrr.lsp")}]
} -body {
    rw $p
    rw $p
} -cleanup {
    ::constcl::close-input-port $p
    removeFile testrr.lsp
} -output "foo\nbar\n"


cleanupTests
return
