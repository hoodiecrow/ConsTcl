package require tcltest
source constcl.tcl
namespace import -force tcltest::*


test macros-7.0 {expand for macro} -body {
    pxw "(for ((i '(1 2 3))) (display i))"
} -output "(begin (let ((i 1)) (display i)) (let ((i 2)) (display i)) (let ((i 3)) (display i)) (quote ()))\n"

test macros-7.1 {run for macro} -body {
    pew "(for ((i (quote (1 2 3)))) (display i))"
} -result "" -output 123()\n

test macros-7.2 {expand for macro} -body {
    pxw "(for ((i 4)) (display i))"
} -output "(begin (let ((i 0)) (display i)) (let ((i 1)) (display i)) (let ((i 2)) (display i)) (let ((i 3)) (display i)) (quote ()))\n"

test macros-7.3 {run for macro} -body {
    pew "(for ((i 4)) (display i))"
} -result "" -output "0123()\n"


cleanupTests
return
