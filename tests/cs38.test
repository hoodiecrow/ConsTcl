
package require tcltest
namespace import -force tcltest::*
source constcl.tcl

test macros-10.0 {expand for macro} -body {
    pxw "(for/or ((i '(1 2 3))) (< 3 i))"
} -output "(or (let ((i 1)) (< 3 i)) (let ((i 2)) (< 3 i)) (let ((i 3)) (< 3 i)))\n"


test macros-12.2 {expand or macro} -body {
    pxw "(or)"
    pxw "(or #f)"
    pxw "(or (> 3 2))"
    pxw "(or (> 3 2) (= 7 8))"
} -output "(begin #f)\n(begin #f)\n(begin (> 3 2))\n(let ((x (> 3 2))) (if x x (let ((x (= 7 8))) (if x x #f))))\n"


cleanupTests
return
